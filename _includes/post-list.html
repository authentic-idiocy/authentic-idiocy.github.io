<!-- _includes/post-list.html -->
<div class="post-index">
  {% comment %} everything exactly as in the previous snippet {% endcomment %}
  {% assign groups = site.posts | group_by_exp: "p", "p.categories | last" %}
  {% assign groups = groups | sort: "name" %}
  {% for g in groups %}
    <h3 class="post-category">{{ g.name | upcase }}</h3>
    <ul class="post-list">
      {% for post in g.items %}
        <li class="post-item">
          <a href="{{ post.url }}">{{ post.title }}</a>
        </li>
      {% endfor %}
    </ul>
  {% endfor %}
  {% if groups == empty %}
    <p><em>Nothing here yet.</em></p>
  {% endif %}
</div>
